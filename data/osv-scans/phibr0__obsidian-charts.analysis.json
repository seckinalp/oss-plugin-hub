{
  "analyzedAt": "2025-12-17T20:07:21.637Z",
  "source": "phibr0__obsidian-charts.osv.json",
  "summary": {
    "totalVulnerabilities": 7,
    "uniqueVulnerabilities": 7,
    "affectedPackages": 6,
    "stalePackages": 7,
    "stalePackagesOldFix": 5,
    "severityBreakdown": {
      "CRITICAL": 0,
      "HIGH": 0,
      "MEDIUM": 0,
      "LOW": 7
    },
    "recentVulnerabilities": 0,
    "hasFixAvailable": 7
  },
  "vulnerabilities": [
    {
      "id": "GHSA-v6h2-p8h4-qcjw",
      "severity": "LOW",
      "severityScore": 3.1,
      "cvssScores": [
        {
          "score": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L",
          "type": "CVSS_V3"
        },
        {
          "score": "CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X",
          "type": "CVSS_V4"
        }
      ],
      "aliases": [
        "CVE-2025-5889"
      ],
      "summary": "brace-expansion Regular Expression Denial of Service vulnerability",
      "details": "A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is `a5b98a4f30d7813266b221435e1eaaf25a1b0ac5`. It is recommended to upgrade the affected component.",
      "cwes": [
        {
          "id": "CWE-400",
          "name": "Uncontrolled Resource Consumption (DoS)"
        }
      ],
      "age": {
        "age": "Last Year",
        "isRecent": false,
        "publishedDate": "2025-06-09T21:30:51Z",
        "modifiedDate": "2025-06-11T20:54:10Z",
        "daysSincePublished": 190
      },
      "affected": {
        "package": "brace-expansion",
        "version": "1.1.11",
        "ecosystem": "npm"
      },
      "fix": {
        "isStale": true,
        "currentVersion": "1.1.11",
        "fixedIn": "2.0.2",
        "recommendation": "Upgrade to 2.0.2 or later",
        "fixAvailableSince": "2025-06-11T20:54:10.000Z",
        "daysSinceFix": 188,
        "monthsSinceFix": 6,
        "isOldFix": true
      },
      "references": [
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-5889"
        },
        {
          "type": "WEB",
          "url": "https://github.com/juliangruber/brace-expansion/pull/65/commits/a5b98a4f30d7813266b221435e1eaaf25a1b0ac5"
        },
        {
          "type": "WEB",
          "url": "https://github.com/juliangruber/brace-expansion/commit/0b6a9781e18e9d2769bb2931f4856d1360243ed2"
        },
        {
          "type": "WEB",
          "url": "https://github.com/juliangruber/brace-expansion/commit/15f9b3c75ebf5988198241fecaebdc45eff28a9f"
        },
        {
          "type": "WEB",
          "url": "https://github.com/juliangruber/brace-expansion/commit/36603d5f3599a37af9e85eda30acd7d28599c36e"
        },
        {
          "type": "WEB",
          "url": "https://github.com/juliangruber/brace-expansion/commit/c3c73c8b088defc70851843be88ccc3af08e7217"
        },
        {
          "type": "WEB",
          "url": "https://gist.github.com/mmmsssttt404/37a40ce7d6e5ca604858fe30814d9466"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/juliangruber/brace-expansion"
        },
        {
          "type": "WEB",
          "url": "https://vuldb.com/?ctiid.311660"
        },
        {
          "type": "WEB",
          "url": "https://vuldb.com/?id.311660"
        },
        {
          "type": "WEB",
          "url": "https://vuldb.com/?submit.585717"
        }
      ]
    },
    {
      "id": "GHSA-grv7-fg5c-xmjg",
      "severity": "LOW",
      "severityScore": 3.1,
      "cvssScores": [
        {
          "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "type": "CVSS_V3"
        }
      ],
      "aliases": [
        "CVE-2024-4068"
      ],
      "summary": "Uncontrolled resource consumption in braces",
      "details": "The NPM package `braces` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In `lib/parse.js,` if a malicious user sends \"imbalanced braces\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.\n",
      "cwes": [
        {
          "id": "CWE-1050",
          "name": "Unknown CWE"
        },
        {
          "id": "CWE-400",
          "name": "Uncontrolled Resource Consumption (DoS)"
        }
      ],
      "age": {
        "age": "1 year(s) old",
        "isRecent": false,
        "publishedDate": "2024-05-14T18:30:54Z",
        "modifiedDate": "2024-07-15T22:12:28.795792Z",
        "daysSincePublished": 582
      },
      "affected": {
        "package": "braces",
        "version": "3.0.2",
        "ecosystem": "npm"
      },
      "fix": {
        "isStale": true,
        "currentVersion": "3.0.2",
        "fixedIn": "3.0.3",
        "recommendation": "Upgrade to 3.0.3 or later",
        "fixAvailableSince": "2024-07-15T22:12:28.795Z",
        "daysSinceFix": 519,
        "monthsSinceFix": 17,
        "isOldFix": true
      },
      "references": [
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-4068"
        },
        {
          "type": "WEB",
          "url": "https://github.com/micromatch/braces/issues/35"
        },
        {
          "type": "WEB",
          "url": "https://github.com/micromatch/braces/pull/37"
        },
        {
          "type": "WEB",
          "url": "https://github.com/micromatch/braces/pull/40"
        },
        {
          "type": "WEB",
          "url": "https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff"
        },
        {
          "type": "WEB",
          "url": "https://devhub.checkmarx.com/cve-details/CVE-2024-4068"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/micromatch/braces"
        },
        {
          "type": "WEB",
          "url": "https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308"
        }
      ]
    },
    {
      "id": "GHSA-67mh-4wv8-2f99",
      "severity": "LOW",
      "severityScore": 3.1,
      "cvssScores": [
        {
          "score": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "type": "CVSS_V3"
        }
      ],
      "aliases": [],
      "summary": "esbuild enables any website to send any requests to the development server and read the response",
      "details": "### Summary\n\nesbuild allows any websites to send any request to the development server and read the response due to default CORS settings.\n\n### Details\n\nesbuild sets `Access-Control-Allow-Origin: *` header to all requests, including the SSE connection, which allows any websites to send any request to the development server and read the response.\n\nhttps://github.com/evanw/esbuild/blob/df815ac27b84f8b34374c9182a93c94718f8a630/pkg/api/serve_other.go#L121\nhttps://github.com/evanw/esbuild/blob/df815ac27b84f8b34374c9182a93c94718f8a630/pkg/api/serve_other.go#L363\n\n**Attack scenario**:\n\n1. The attacker serves a malicious web page (`http://malicious.example.com`).\n1. The user accesses the malicious web page.\n1. The attacker sends a `fetch('http://127.0.0.1:8000/main.js')` request by JS in that malicious web page. This request is normally blocked by same-origin policy, but that's not the case for the reasons above.\n1. The attacker gets the content of `http://127.0.0.1:8000/main.js`.\n\nIn this scenario, I assumed that the attacker knows the URL of the bundle output file name. But the attacker can also get that information by\n\n- Fetching `/index.html`: normally you have a script tag here\n- Fetching `/assets`: it's common to have a `assets` directory when you have JS files and CSS files in a different directory and the directory listing feature tells the attacker the list of files\n- Connecting `/esbuild` SSE endpoint: the SSE endpoint sends the URL path of the changed files when the file is changed (`new EventSource('/esbuild').addEventListener('change', e => console.log(e.type, e.data))`)\n- Fetching URLs in the known file: once the attacker knows one file, the attacker can know the URLs imported from that file\n\nThe scenario above fetches the compiled content, but if the victim has the source map option enabled, the attacker can also get the non-compiled content by fetching the source map file.\n\n### PoC\n\n1. Download [reproduction.zip](https://github.com/user-attachments/files/18561484/reproduction.zip)\n2. Extract it and move to that directory\n1. Run `npm i`\n1. Run `npm run watch`\n1. Run `fetch('http://127.0.0.1:8000/app.js').then(r => r.text()).then(content => console.log(content))` in a different website's dev tools.\n\n![image](https://github.com/user-attachments/assets/08fc2e4d-e1ec-44ca-b0ea-78a73c3c40e9)\n\n### Impact\n\nUsers using the serve feature may get the source code stolen by malicious websites.",
      "cwes": [
        {
          "id": "CWE-346",
          "name": "Unknown CWE"
        }
      ],
      "age": {
        "age": "Last Year",
        "isRecent": false,
        "publishedDate": "2025-02-10T17:48:07Z",
        "modifiedDate": "2025-02-10T17:48:08Z",
        "daysSincePublished": 310
      },
      "affected": {
        "package": "esbuild",
        "version": "0.12.29",
        "ecosystem": "npm"
      },
      "fix": {
        "isStale": true,
        "currentVersion": "0.12.29",
        "fixedIn": "0.25.0",
        "recommendation": "Upgrade to 0.25.0 or later",
        "fixAvailableSince": "2025-02-10T17:48:08.000Z",
        "daysSinceFix": 310,
        "monthsSinceFix": 10,
        "isOldFix": true
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/evanw/esbuild/security/advisories/GHSA-67mh-4wv8-2f99"
        },
        {
          "type": "WEB",
          "url": "https://github.com/evanw/esbuild/commit/de85afd65edec9ebc44a11e245fd9e9a2e99760d"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/evanw/esbuild"
        }
      ]
    },
    {
      "id": "GHSA-8hfj-j24r-96c4",
      "severity": "LOW",
      "severityScore": 3.1,
      "cvssScores": [
        {
          "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "type": "CVSS_V3"
        }
      ],
      "aliases": [
        "CVE-2022-24785"
      ],
      "summary": "Path Traversal: 'dir/../../filename' in moment.locale",
      "details": "### Impact\nThis vulnerability impacts npm (server) users of moment.js, especially if user provided locale string, eg `fr` is directly used to switch moment locale.\n\n### Patches\nThis problem is patched in 2.29.2, and the patch can be applied to all affected versions (from 1.0.1 up until 2.29.1, inclusive).\n\n### Workarounds\nSanitize user-provided locale name before passing it to moment.js.\n\n### References\n_Are there any links users can visit to find out more?_\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [moment repo](https://github.com/moment/moment)",
      "cwes": [
        {
          "id": "CWE-22",
          "name": "Unknown CWE"
        },
        {
          "id": "CWE-27",
          "name": "Unknown CWE"
        }
      ],
      "age": {
        "age": "3 year(s) old",
        "isRecent": false,
        "publishedDate": "2022-04-04T21:25:48Z",
        "modifiedDate": "2025-11-04T17:01:47.910754Z",
        "daysSincePublished": 1352
      },
      "affected": {
        "package": "moment",
        "version": "2.29.1",
        "ecosystem": "npm"
      },
      "fix": {
        "isStale": true,
        "currentVersion": "2.29.1",
        "fixedIn": "2.29.2",
        "recommendation": "Upgrade to 2.29.2 or later",
        "fixAvailableSince": "2025-11-04T17:01:47.910Z",
        "daysSinceFix": 43,
        "monthsSinceFix": 1,
        "isOldFix": false
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/moment/moment/security/advisories/GHSA-8hfj-j24r-96c4"
        },
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-24785"
        },
        {
          "type": "WEB",
          "url": "https://github.com/moment/moment/commit/4211bfc8f15746be4019bba557e29a7ba83d54c5"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/moment/moment"
        },
        {
          "type": "WEB",
          "url": "https://lists.debian.org/debian-lts-announce/2023/01/msg00035.html"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6QIO6YNLTK2T7SPKDS4JEL45FANLNC2Q"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ORJX2LF6KMPIHP6B2P6KZIVKMLE3LVJ5"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6QIO6YNLTK2T7SPKDS4JEL45FANLNC2Q"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ORJX2LF6KMPIHP6B2P6KZIVKMLE3LVJ5"
        },
        {
          "type": "WEB",
          "url": "https://security.netapp.com/advisory/ntap-20220513-0006"
        },
        {
          "type": "WEB",
          "url": "https://security.netapp.com/advisory/ntap-20241108-0002"
        },
        {
          "type": "WEB",
          "url": "https://www.tenable.com/security/tns-2022-09"
        }
      ]
    },
    {
      "id": "GHSA-wc69-rhjr-hc9g",
      "severity": "LOW",
      "severityScore": 3.1,
      "cvssScores": [
        {
          "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "type": "CVSS_V3"
        }
      ],
      "aliases": [
        "CVE-2022-31129"
      ],
      "summary": "Moment.js vulnerable to Inefficient Regular Expression Complexity",
      "details": "### Impact\n\n* using string-to-date parsing in moment (more specifically rfc2822 parsing, which is tried by default) has quadratic (N^2) complexity on specific inputs\n* noticeable slowdown is observed with inputs above 10k characters\n* users who pass user-provided strings without sanity length checks to moment constructor are vulnerable to (Re)DoS attacks\n\n### Patches\nThe problem is patched in 2.29.4, the patch can be applied to all affected versions with minimal tweaking.\n\n### Workarounds\nIn general, given the proliferation of ReDoS attacks, it makes sense to limit the length of the user input to something sane, like 200 characters or less. I haven't seen legitimate cases of date-time strings longer than that, so all moment users who do pass a user-originating string to constructor are encouraged to apply such a rudimentary filter, that would help with this but also most future ReDoS vulnerabilities.\n\n### References\nThere is an excellent writeup of the issue here: https://github.com/moment/moment/pull/6015#issuecomment-1152961973=\n\n### Details\nThe issue is rooted in the code that removes legacy comments (stuff inside parenthesis) from strings during rfc2822 parsing. `moment(\"(\".repeat(500000))` will take a few minutes to process, which is unacceptable.",
      "cwes": [
        {
          "id": "CWE-1333",
          "name": "Inefficient Regular Expression Complexity (ReDoS)"
        },
        {
          "id": "CWE-400",
          "name": "Uncontrolled Resource Consumption (DoS)"
        }
      ],
      "age": {
        "age": "3 year(s) old",
        "isRecent": false,
        "publishedDate": "2022-07-06T18:38:49Z",
        "modifiedDate": "2025-11-04T17:01:02.311117Z",
        "daysSincePublished": 1260
      },
      "affected": {
        "package": "moment",
        "version": "2.29.1",
        "ecosystem": "npm"
      },
      "fix": {
        "isStale": true,
        "currentVersion": "2.29.1",
        "fixedIn": "2.29.4",
        "recommendation": "Upgrade to 2.29.4 or later",
        "fixAvailableSince": "2025-11-04T17:01:02.311Z",
        "daysSinceFix": 43,
        "monthsSinceFix": 1,
        "isOldFix": false
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/moment/moment/security/advisories/GHSA-wc69-rhjr-hc9g"
        },
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-31129"
        },
        {
          "type": "WEB",
          "url": "https://github.com/moment/moment/pull/6015#issuecomment-1152961973"
        },
        {
          "type": "WEB",
          "url": "https://github.com/moment/moment/pull/6015/commits/4bbb9f3ccbe231de40207503f344fe5ce97584f4"
        },
        {
          "type": "WEB",
          "url": "https://github.com/moment/moment/pull/6015/commits/bfd4f2375d5c1a2106246721d693a9611dddfbfe"
        },
        {
          "type": "WEB",
          "url": "https://github.com/moment/moment/pull/6015/commits/dc0d180e90d8a84f7ff13572363330a22b3ea504"
        },
        {
          "type": "WEB",
          "url": "https://github.com/moment/moment/commit/9a3b5894f3d5d602948ac8a02e4ee528a49ca3a3"
        },
        {
          "type": "WEB",
          "url": "https://security.netapp.com/advisory/ntap-20241108-0002"
        },
        {
          "type": "WEB",
          "url": "https://security.netapp.com/advisory/ntap-20221014-0003"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZMX5YHELQVCGKKQVFXIYOTBMN23YYSRO"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ORJX2LF6KMPIHP6B2P6KZIVKMLE3LVJ5"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IWY24RJA3SBJGA5N4CU4VBPHJPPPJL5O"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6QIO6YNLTK2T7SPKDS4JEL45FANLNC2Q"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZMX5YHELQVCGKKQVFXIYOTBMN23YYSRO"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ORJX2LF6KMPIHP6B2P6KZIVKMLE3LVJ5"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/IWY24RJA3SBJGA5N4CU4VBPHJPPPJL5O"
        },
        {
          "type": "WEB",
          "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6QIO6YNLTK2T7SPKDS4JEL45FANLNC2Q"
        },
        {
          "type": "WEB",
          "url": "https://lists.debian.org/debian-lts-announce/2023/01/msg00035.html"
        },
        {
          "type": "WEB",
          "url": "https://huntr.dev/bounties/f0952b67-f2ff-44a9-a9cd-99e0a87cb633"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/moment/moment"
        }
      ]
    },
    {
      "id": "GHSA-gcx4-mw62-g8wm",
      "severity": "LOW",
      "severityScore": 3.1,
      "cvssScores": [
        {
          "score": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H",
          "type": "CVSS_V3"
        },
        {
          "score": "CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:L/VI:L/VA:H/SC:N/SI:N/SA:N",
          "type": "CVSS_V4"
        }
      ],
      "aliases": [
        "CVE-2024-47068"
      ],
      "summary": "DOM Clobbering Gadget found in rollup bundled scripts that leads to XSS",
      "details": "### Summary\n\nWe discovered a DOM Clobbering vulnerability in rollup when bundling scripts that use `import.meta.url` or with plugins that emit and reference asset files from code  in `cjs`/`umd`/`iife` format. The DOM Clobbering gadget can lead to cross-site scripting (XSS) in web pages where scriptless attacker-controlled HTML elements (e.g., an `img` tag with an unsanitized `name` attribute) are present.\n\nIt's worth noting that weâ€™ve identifed similar issues in other popular bundlers like Webpack ([CVE-2024-43788](https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986)), which might serve as a good reference.\n\n### Details\n\n#### Backgrounds\n\nDOM Clobbering is a type of code-reuse attack where the attacker first embeds a piece of non-script, seemingly benign HTML markups in the webpage (e.g. through a post or comment) and leverages the gadgets (pieces of js code) living in the existing javascript code to transform it into executable code. More for information about DOM Clobbering, here are some references:\n\n[1] https://scnps.co/papers/sp23_domclob.pdf\n[2] https://research.securitum.com/xss-in-amp4email-dom-clobbering/\n\n#### Gadget found in `rollup`\n\nWe have identified a DOM Clobbering vulnerability in `rollup` bundled scripts, particularly when the scripts uses `import.meta` and set output in format of  `cjs`/`umd`/`iife`. In such cases, `rollup` replaces meta property with the URL retrieved from `document.currentScript`.\n\nhttps://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162\n\nhttps://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185\n\nHowever, this implementation is vulnerable to a DOM Clobbering attack. The `document.currentScript` lookup can be shadowed by an attacker via the browser's named DOM tree element access mechanism. This manipulation allows an attacker to replace the intended script element with a malicious HTML element. When this happens, the `src` attribute of the attacker-controlled element (e.g., an `img` tag ) is used as the URL for importing scripts, potentially leading to the dynamic loading of scripts from an attacker-controlled server.\n\n### PoC\n\nConsidering a website that contains the following `main.js` script, the devloper decides to use the `rollup` to bundle up the program: `rollup main.js --format cjs --file bundle.js`.\n\n```\nvar s = document.createElement('script')\ns.src = import.meta.url + 'extra.js'\ndocument.head.append(s)\n```\n\nThe output `bundle.js` is shown in the following code snippet.\n\n```\n'use strict';\n\nvar _documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null;\nvar s = document.createElement('script');\ns.src = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(__filename).href : (_documentCurrentScript && False && _documentCurrentScript.src || new URL('bundle.js', document.baseURI).href)) + 'extra.js';\ndocument.head.append(s);\n```\n\nAdding the `rollup` bundled script, `bundle.js`, as part of the web page source code, the page could load the `extra.js` file from the attacker's domain, `attacker.controlled.server` due to the introduced gadget during bundling. The attacker only needs to insert an `img` tag with the name attribute set to `currentScript`. This can be done through a website's feature that allows users to embed certain script-less HTML (e.g., markdown renderers, web email clients, forums) or via an HTML injection vulnerability in third-party JavaScript loaded on the page.\n\n```\n<!DOCTYPE html>\n<html>\n<head>\n  <title>rollup Example</title>\n  <!-- Attacker-controlled Script-less HTML Element starts--!>\n  <img name=\"currentScript\" src=\"https://attacker.controlled.server/\"></img>\n  <!-- Attacker-controlled Script-less HTML Element ends--!>\n</head>\n<script type=\"module\" crossorigin src=\"bundle.js\"></script>\n<body>\n</body>\n</html>\n```\n\n### Impact\n\nThis vulnerability can result in cross-site scripting (XSS) attacks on websites that include rollup-bundled files (configured with an output format of `cjs`, `iife`, or `umd` and use `import.meta`) and allow users to inject certain scriptless HTML tags without properly sanitizing the `name` or `id` attributes.\n\n### Patch\n\nPatching the following two functions with type checking would be effective mitigations against DOM Clobbering attack.\n\n```\nconst getRelativeUrlFromDocument = (relativePath: string, umd = false) =>\n\tgetResolveUrl(\n\t\t`'${escapeId(relativePath)}', ${\n\t\t\tumd ? `typeof document === 'undefined' ? location.href : ` : ''\n\t\t}document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI`\n\t);\n```\n\n```\nconst getUrlFromDocument = (chunkId: string, umd = false) =>\n\t`${\n\t\tumd ? `typeof document === 'undefined' ? location.href : ` : ''\n\t}(${DOCUMENT_CURRENT_SCRIPT} && ${DOCUMENT_CURRENT_SCRIPT}.tagName.toUpperCase() === 'SCRIPT' &&${DOCUMENT_CURRENT_SCRIPT}.src || new URL('${escapeId(\n\t\tchunkId\n\t)}', document.baseURI).href)`;\n```\n",
      "cwes": [
        {
          "id": "CWE-79",
          "name": "Cross-Site Scripting (XSS)"
        }
      ],
      "age": {
        "age": "1 year(s) old",
        "isRecent": false,
        "publishedDate": "2024-09-23T22:11:02Z",
        "modifiedDate": "2024-09-26T21:11:53Z",
        "daysSincePublished": 449
      },
      "affected": {
        "package": "rollup",
        "version": "2.77.0",
        "ecosystem": "npm"
      },
      "fix": {
        "isStale": true,
        "currentVersion": "2.77.0",
        "fixedIn": "3.29.5",
        "recommendation": "Upgrade to 3.29.5 or later",
        "fixAvailableSince": "2024-09-26T21:11:53.000Z",
        "daysSinceFix": 446,
        "monthsSinceFix": 14,
        "isOldFix": true
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/rollup/rollup/security/advisories/GHSA-gcx4-mw62-g8wm"
        },
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-47068"
        },
        {
          "type": "WEB",
          "url": "https://github.com/rollup/rollup/commit/2ef77c00ec2635d42697cff2c0567ccc8db34fb4"
        },
        {
          "type": "WEB",
          "url": "https://github.com/rollup/rollup/commit/e2552c9e955e0a61f70f508200ee9f752f85a541"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/rollup/rollup"
        },
        {
          "type": "WEB",
          "url": "https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162"
        },
        {
          "type": "WEB",
          "url": "https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185"
        }
      ]
    },
    {
      "id": "GHSA-8266-84wp-wv5c",
      "severity": "LOW",
      "severityScore": 3.1,
      "cvssScores": [
        {
          "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
          "type": "CVSS_V3"
        },
        {
          "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N",
          "type": "CVSS_V4"
        }
      ],
      "aliases": [
        "CVE-2024-45047"
      ],
      "summary": "Svelte has a potential mXSS vulnerability due to improper HTML escaping",
      "details": "### Summary\n\nA potential XSS vulnerability exists in Svelte for versions prior to 4.2.19.\n\n### Details\n\nSvelte improperly escapes HTML on server-side rendering. It converts strings according to the following rules:\n\n- If the string is an attribute value:\n    - `\"` -> `&quot;`\n    - `&` -> `&amp;`\n    - Other characters -> No conversion\n- Otherwise:\n    - `<` -> `&lt;`\n    - `&` -> `&amp;`\n    - Other characters -> No conversion\n\nThe assumption is that attributes will always stay as such, but in some situation the final DOM tree rendered on browsers is different from what Svelte expects on server-side rendering. This may be leveraged to perform XSS attacks. More specifically, this can occur when injecting malicious content into an attribute within a `<noscript>` tag.\n\n### PoC\n\nA vulnerable page (`+page.svelte`):\n```html\n<script>\nimport { page } from \"$app/stores\"\n\n// user input\nlet href = $page.url.searchParams.get(\"href\") ?? \"https://example.com\";\n</script>\n\n<noscript>\n  <a href={href}>test</a>\n</noscript>\n```\n\nIf a user accesses the following URL,\n```\nhttp://localhost:4173/?href=</noscript><script>alert(123)</script>\n```\nthen, `alert(123)` will be executed.\n\n### Impact\n\nXSS, when using an attribute within a noscript tag",
      "cwes": [
        {
          "id": "CWE-79",
          "name": "Cross-Site Scripting (XSS)"
        }
      ],
      "age": {
        "age": "1 year(s) old",
        "isRecent": false,
        "publishedDate": "2024-08-30T16:49:10Z",
        "modifiedDate": "2024-08-30T20:01:23Z",
        "daysSincePublished": 474
      },
      "affected": {
        "package": "svelte",
        "version": "3.49.0",
        "ecosystem": "npm"
      },
      "fix": {
        "isStale": true,
        "currentVersion": "3.49.0",
        "fixedIn": "4.2.19",
        "recommendation": "Upgrade to 4.2.19 or later",
        "fixAvailableSince": "2024-08-30T20:01:23.000Z",
        "daysSinceFix": 474,
        "monthsSinceFix": 15,
        "isOldFix": true
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/sveltejs/svelte/security/advisories/GHSA-8266-84wp-wv5c"
        },
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-45047"
        },
        {
          "type": "WEB",
          "url": "https://github.com/sveltejs/svelte/commit/83e96e044deb5ecbae2af361ae9e31d3e1ac43a3"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/sveltejs/svelte"
        }
      ]
    }
  ],
  "staleDependencies": [
    {
      "package": "brace-expansion",
      "currentVersion": "1.1.11",
      "fixedIn": "2.0.2",
      "vulnerabilities": [
        "GHSA-v6h2-p8h4-qcjw"
      ],
      "severity": "LOW",
      "recommendation": "Upgrade to 2.0.2 or later",
      "fixAvailableSince": "2025-06-11T20:54:10.000Z",
      "daysSinceFix": 188,
      "monthsSinceFix": 6,
      "isOldFix": true
    },
    {
      "package": "braces",
      "currentVersion": "3.0.2",
      "fixedIn": "3.0.3",
      "vulnerabilities": [
        "GHSA-grv7-fg5c-xmjg"
      ],
      "severity": "LOW",
      "recommendation": "Upgrade to 3.0.3 or later",
      "fixAvailableSince": "2024-07-15T22:12:28.795Z",
      "daysSinceFix": 519,
      "monthsSinceFix": 17,
      "isOldFix": true
    },
    {
      "package": "esbuild",
      "currentVersion": "0.12.29",
      "fixedIn": "0.25.0",
      "vulnerabilities": [
        "GHSA-67mh-4wv8-2f99"
      ],
      "severity": "LOW",
      "recommendation": "Upgrade to 0.25.0 or later",
      "fixAvailableSince": "2025-02-10T17:48:08.000Z",
      "daysSinceFix": 310,
      "monthsSinceFix": 10,
      "isOldFix": true
    },
    {
      "package": "moment",
      "currentVersion": "2.29.1",
      "fixedIn": "2.29.2",
      "vulnerabilities": [
        "GHSA-8hfj-j24r-96c4",
        "GHSA-wc69-rhjr-hc9g"
      ],
      "severity": "LOW",
      "recommendation": "Upgrade to 2.29.2 or later",
      "fixAvailableSince": "2025-11-04T17:01:47.910Z",
      "daysSinceFix": 43,
      "monthsSinceFix": 1,
      "isOldFix": false
    },
    {
      "package": "rollup",
      "currentVersion": "2.77.0",
      "fixedIn": "3.29.5",
      "vulnerabilities": [
        "GHSA-gcx4-mw62-g8wm"
      ],
      "severity": "LOW",
      "recommendation": "Upgrade to 3.29.5 or later",
      "fixAvailableSince": "2024-09-26T21:11:53.000Z",
      "daysSinceFix": 446,
      "monthsSinceFix": 14,
      "isOldFix": true
    },
    {
      "package": "svelte",
      "currentVersion": "3.49.0",
      "fixedIn": "4.2.19",
      "vulnerabilities": [
        "GHSA-8266-84wp-wv5c"
      ],
      "severity": "LOW",
      "recommendation": "Upgrade to 4.2.19 or later",
      "fixAvailableSince": "2024-08-30T20:01:23.000Z",
      "daysSinceFix": 474,
      "monthsSinceFix": 15,
      "isOldFix": true
    }
  ],
  "recommendations": [
    {
      "priority": "HIGH",
      "message": "5 packages have fixes available for >6 months. Update urgently!"
    },
    {
      "priority": "MEDIUM",
      "message": "7 packages have known vulnerabilities with available fixes. Update recommended."
    }
  ]
}