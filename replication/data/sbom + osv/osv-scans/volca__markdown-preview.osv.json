{
  "results": [
    {
      "source": {
        "path": "/sboms/volca__markdown-preview.spdx.json",
        "type": "sbom"
      },
      "packages": [
        {
          "package": {
            "name": "mermaid",
            "version": "11.6.0",
            "ecosystem": "npm"
          },
          "groups": [
            {
              "ids": [
                "GHSA-7rqq-prvp-x9jh"
              ],
              "aliases": [
                "CVE-2025-54881",
                "GHSA-7rqq-prvp-x9jh"
              ],
              "max_severity": "5.3"
            },
            {
              "ids": [
                "GHSA-8gwm-58g9-j8pw"
              ],
              "aliases": [
                "CVE-2025-54880",
                "GHSA-8gwm-58g9-j8pw"
              ],
              "max_severity": "5.1"
            }
          ],
          "vulnerabilities": [
            {
              "affected": [
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-7rqq-prvp-x9jh/GHSA-7rqq-prvp-x9jh.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "mermaid",
                    "purl": "pkg:npm/mermaid"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "11.0.0-alpha.1"
                        },
                        {
                          "fixed": "11.10.0"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                },
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-7rqq-prvp-x9jh/GHSA-7rqq-prvp-x9jh.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "mermaid",
                    "purl": "pkg:npm/mermaid"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "10.9.0-rc.1"
                        },
                        {
                          "fixed": "10.9.4"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                }
              ],
              "aliases": [
                "CVE-2025-54881"
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-79"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2025-08-19T20:16:58Z",
                "nvd_published_at": "2025-08-19T17:15:41Z",
                "severity": "MODERATE"
              },
              "details": "### Summary\nIn the default configuration of mermaid 11.9.0, user supplied input for sequence diagram labels is passed to `innerHTML` during calculation of element size, causing XSS.\n\n### Details\nSequence diagram node labels with KaTeX delimiters are passed through `calculateMathMLDimensions`. This method passes the full label to `innerHTML` which allows allows malicious users to inject arbitrary HTML and cause XSS when mermaid-js is used in it's default configuration (with KaTeX support enabled). \n\nThe vulnerability lies here:\n\n```ts\nexport const calculateMathMLDimensions = async (text: string, config: MermaidConfig) =\u003e {\n  text = await renderKatex(text, config);\n  const divElem = document.createElement('div');\n  divElem.innerHTML = text; // XSS sink, text has not been sanitized.\n  divElem.id = 'katex-temp';\n  divElem.style.visibility = 'hidden';\n  divElem.style.position = 'absolute';\n  divElem.style.top = '0';\n  const body = document.querySelector('body');\n  body?.insertAdjacentElement('beforeend', divElem);\n  const dim = { width: divElem.clientWidth, height: divElem.clientHeight };\n  divElem.remove();\n  return dim;\n};\n```\n\nThe `calculateMathMLDimensions` method was introduced in 5c69e5fdb004a6d0a2abe97e23d26e223a059832 two years ago, which was released in [Mermaid 10.9.0](https://github.com/mermaid-js/mermaid/releases/tag/v10.9.0).\n\n### PoC\nRender the following diagram and observe the modified DOM.\n\n```\nsequenceDiagram\n    participant A as Alice\u003cimg src=\"x\" onerror=\"document.write(`xss on ${document.domain}`)\"\u003e$$\\\\text{Alice}$$\n    A-\u003e\u003eJohn: Hello John, how are you?\n    Alice-)John: See you later!\n```\n\nHere is a PoC on mermaid.live: https://mermaid.live/edit#pako:eNpVUMtOwzAQ_BWzyoFKaRTyaFILiio4IK7ckA-1km1iKbaLY6spUf4dJ0AF68uOZ2dm7REqXSNQ6PHDoarwWfDGcMkUudaJGysqceLKkj3hPdl3osJ7IRvSm-qBwcCAaIXGaONRrSsnUdnobITF28PQ954lwXglai25UNNhxWAXBMyXxcGOi-3kL_5k79e73atuFSUv2HWazH1IWn0m3CC5aPf4b3p2WK--BW-4DJCOWzQ3TM0HQmiMqIFa4zAEicZv4iGMsw0D26JEBtS3NR656ywDpiYv869_11r-Ko12TQv0yLveI3eqfcjP111HUNVonrRTFuhdsVgAHWEAmuRxlG7SuEzKMi-yJAnhAjTLIk_EcbFJtuk2y9MphM8lM47KIp--AOZghtU\n\n### Impact\nXSS on all sites that use mermaid and render user supplied diagrams without further sanitization.\n\n### Remediation\nThe value of the `text` argument for the `calculateMathMLDimensions` method needs to be sanitized before getting passed on to `innerHTML`.",
              "id": "GHSA-7rqq-prvp-x9jh",
              "modified": "2025-08-22T22:52:04Z",
              "published": "2025-08-19T20:16:58Z",
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/mermaid-js/mermaid/security/advisories/GHSA-7rqq-prvp-x9jh"
                },
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-54881"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/mermaid-js/mermaid/commit/5c69e5fdb004a6d0a2abe97e23d26e223a059832"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/mermaid-js/mermaid/commit/685516a85ec1df64cefd4fd15f26533be87d458e"
                },
                {
                  "type": "PACKAGE",
                  "url": "https://github.com/mermaid-js/mermaid"
                }
              ],
              "related": [
                "CGA-pqgj-hfwc-hr2q"
              ],
              "schema_version": "1.7.3",
              "severity": [
                {
                  "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N",
                  "type": "CVSS_V4"
                }
              ],
              "summary": "Mermaid improperly sanitizes sequence diagram labels leading to XSS"
            },
            {
              "affected": [
                {
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/08/GHSA-8gwm-58g9-j8pw/GHSA-8gwm-58g9-j8pw.json"
                  },
                  "package": {
                    "ecosystem": "npm",
                    "name": "mermaid",
                    "purl": "pkg:npm/mermaid"
                  },
                  "ranges": [
                    {
                      "events": [
                        {
                          "introduced": "11.1.0"
                        },
                        {
                          "fixed": "11.10.0"
                        }
                      ],
                      "type": "SEMVER"
                    }
                  ]
                }
              ],
              "aliases": [
                "CVE-2025-54880"
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-79"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2025-08-19T20:16:45Z",
                "nvd_published_at": "2025-08-19T17:15:41Z",
                "severity": "MODERATE"
              },
              "details": "### Summary\nIn the default configuration of mermaid 11.9.0, user supplied input for architecture diagram icons is passed to the d3 `html()` method, creating a sink for cross site scripting.\n\n### Details\nArchitecture diagram service `iconText` values are passed to the d3 `html()` method, allowing malicious users to inject arbitrary HTML and cause XSS when mermaid-js is used in it's default configuration. \n\nThe vulnerability lies here:\n\n```ts\nexport const drawServices = async function (\n  db: ArchitectureDB,\n  elem: D3Element,\n  services: ArchitectureService[]\n): Promise\u003cnumber\u003e {\n  for (const service of services) {\n    /** ... **/\n    } else if (service.iconText) {\n      bkgElem.html(\n        `\u003cg\u003e${await getIconSVG('blank', { height: iconSize, width: iconSize, fallbackPrefix: architectureIcons.prefix })}\u003c/g\u003e`\n      );\n      const textElemContainer = bkgElem.append('g');\n      const fo = textElemContainer\n        .append('foreignObject')\n        .attr('width', iconSize)\n        .attr('height', iconSize);\n      const divElem = fo\n        .append('div')\n        .attr('class', 'node-icon-text')\n        .attr('style', `height: ${iconSize}px;`)\n        .append('div')\n        .html(service.iconText); // \u003c- iconText passed into innerHTML\n       /** ... **/\n};\n};\n```\n\nThis issue was introduced with 734bde38777c9190a5a72e96421c83424442d4e4, around 15 months ago, which was released in [v11.1.0](https://github.com/mermaid-js/mermaid/releases/tag/mermaid%4011.1.0).\n\n### PoC\nRender the following diagram and observe the modified DOM.\n\n```\narchitecture-beta\n    group api(cloud)[API]\n    service db \"\u003cimg src=x onerror=\\\"document.write(`xss on ${document.domain}`)\\\"\u003e\" [Database] in api\n```\n\nHere is a PoC on mermaid.live: https://mermaid.live/edit#pako:eNo9T8FOwzAM_ZXI4rBJpWrpRtuIISF24caZZdKyxOsiLUnlJjCo-u9kQ8wX-_n5-dkjKK8ROEhSRxNQhUh4v8cghWMpOvKxZ7I3M3XyUc83L-9v2z9qQPo0CpneMwFPxnZsILU6M--QyNNKCAHaq2jRhfyL0vLZ7jwMiWd3443Q3krjpt38Mv4sgG3WMsi9HHDLjLs4CwcZdGQ08EARM7BISZMgjJdLBIQjWhTAU6nxIOMpCBBuSrJeug_v7b8yPdMdgR_kaUgo9loGXBvZkbS3LqHTSK8-ugC8LMrrEuAjnIEvlnlVL9q6rZu6Lh-rRQbfwKuyyZuybcvqIaWiqKcMfq6uRd7Uy-kXhYFzcA\n\n### Impact\nXSS on all sites that use mermaid and render user supplied diagrams without further sanitization.\n\n### Remediation\nSanitize the value of `iconText` before passing it to `html()`.",
              "id": "GHSA-8gwm-58g9-j8pw",
              "modified": "2025-08-20T19:13:27Z",
              "published": "2025-08-19T20:16:45Z",
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/mermaid-js/mermaid/security/advisories/GHSA-8gwm-58g9-j8pw"
                },
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-54880"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/mermaid-js/mermaid/commit/2aa83302795183ea5c65caec3da1edd6cb4791fc"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/mermaid-js/mermaid/commit/734bde38777c9190a5a72e96421c83424442d4e4"
                },
                {
                  "type": "PACKAGE",
                  "url": "https://github.com/mermaid-js/mermaid"
                }
              ],
              "related": [
                "CGA-9v4g-rf5q-9vx5",
                "CVE-2025-54880"
              ],
              "schema_version": "1.7.3",
              "severity": [
                {
                  "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N",
                  "type": "CVSS_V4"
                }
              ],
              "summary": "Mermaid does not properly sanitize architecture diagram iconText leading to XSS"
            }
          ]
        }
      ]
    }
  ],
  "experimental_config": {
    "licenses": {
      "summary": false,
      "allowlist": null
    }
  }
}
